%Este trabalho está licenciado sob a Licença Creative Commons Atribuição-CompartilhaIgual 3.0 Não Adaptada. Para ver uma cópia desta licença, visite https://creativecommons.org/licenses/by-sa/3.0/ ou envie uma carta para Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.

\chapter{Rápida Introdução ao GNU Octave}\label{cap:octave}\index{GNU Octave}

Neste apêndice, discutiremos os principais aspectos da linguagem computacional \verb+GNU Octave+ que são essenciais para uma boa leitura desta versão do livro. O material aqui apresentado, é uma adaptação livre do apêndice A de \cite{CALSCI}.

\section{Sobre o GNU Octave}\index{Octave!sobre}

\verb+GNU Octave+ é uma linguagem computacional de alto nível para computação numérica. \verb+GNU Octave+ é distribuído livremente sobre licença GPL. A linguagem acompanha um GUI (Interface Gráfica do Utilizador) em versões para Linux, Mac, BSD e Windows. 

Para mais informações sobre o GNU Octave, visite sua página oficial
\begin{center}
  \url{https://www.gnu.org/software/octave/}
\end{center}

O manual oficial do GNU Octave pode ser obtido em:
\begin{center}
  \url{https://www.gnu.org/software/octave/doc/interpreter/}
\end{center}

\section{Instalação e Execução}\index{GNU Octave!instalação e execução}

O \verb+GNU Octave+ pode ser executado normalmente nos sistemas operacionais Linux, Mac Os, BSD e Windows . Muitas distribuições de Linux (Linux Mint, Ubuntu, etc.) têm o \verb+GNU Octave+ no seu sistema de pacotes (incluindo binário e documentação). Alternativamente, no \href{https://www.gnu.org/software/octave/}{site oficial do GNU Octave} pode-se obter mais versões de binários e documentação para instalação.

\section{Usando o GNU Octave}\index{GNU Octave!usando}

O uso do \verb+GNU Octave+ pode ser feito de três formas básicas:
\begin{itemize}
\item usando o {\bf console} de modo iterativo;
\item usando a função \verb+run+ para executar um código GNU Octave digitado em um arquivo externo;
\item usando processamento {\it bash}.
\end{itemize}

\begin{ex}
  Considere o seguinte pseudocódigo:
\begin{verbatim}
s = "Olá, mundo!". (Sem imprimir na tela o resultado.)
saída(s). (Imprime na tela.)
\end{verbatim}
Implemente este pseudocódigo no GNU Octave: a) usando somente o console do \verb+GNU Octave+; b) usando o editor do \verb+GNU Octave+ e executando o código com a função \verb+exec+; c) usando processamento {\it bash}.
\end{ex}
\begin{sol} Seguem as soluções de cada item:
  \begin{itemize}
  \item[a)]  No console temos:
\begin{verbatim}
>> x = "Olá, mundo\n";
>> disp(x)
\end{verbatim}
  \item[b)] O GUI do \verb+GNU Octave+ disponibiliza um editor para {\it scripts} que ser acessado digitando-se no \verb+prompt+:
\begin{verbatim}
-->edit
\end{verbatim}
Então, digita-se no editor o código:
\begin{verbatim}
x = "Olá, mundo!\n";
disp(x);
\end{verbatim}
salva-se em um arquivo de sua preferência com extensão \verb+.m+ (por exemplo, \verb+~/ola.m+) e executa-se o código clicando no botão ``{\it play}'' disponível na barra de botões do editor.
\item[c)] Para executar o código em processamento {\it bash}, digita-se em um editor o código:
\begin{verbatim}
x = "Olá, mundo!\n";
disp(x);
\end{verbatim}
salva-se em um arquivo de sua preferência com extensão \verb+.m+ (por exemplo, \verb+~/ola.m+) e executa-se em um console do sistema usando a linha de comando:
\begin{verbatim}
$ octave ~/ola.m
\end{verbatim}
\end{itemize}
\end{sol}

\section{Elementos da linguagem}\index{GNU Octave!elementos da linguagem}

\verb+GNU Octave+ é uma linguagem interpretada em que as variáveis são matrizes. Uma variável é criada quando um valor é atribuído a ela. Por exemplo:
\begin{verbatim}
>> x=1
x =  1
>> y = x * 2
y =  2  
\end{verbatim}
a variável \verb+x+ recebe o valor \verb+double+ $1$ e, logo após, na segunda linha de comando, a variável \verb+y+ recebe o valor \verb+double+ $2$. Observamos que o símbolo \verb+=+ significa o operador de atribuição não o de igualdade. O operador lógico de igualdade no \verb+GNU Octave+ é \verb+==+.

Comentários e continuação de linha de comando são usados como no seguinte exemplo:
\begin{verbatim}
>> #Isto é um comentário
>> x = 1 ...
+ 2
x =  3  
\end{verbatim}

\subsection{Operações matemáticas elementares}\index{GNU Octave!operações matemáticas}

No \verb+GNU Octave+, os operadores matemáticos elementares são os seguintes:
\begin{verbatim}
  + adição
  - subtração
  * multiplicação
  / divisão
  ^ potenciação
  ' transposto conjugado
\end{verbatim}

\subsection{Funções e constantes elementares}\index{GNU Octave!funções e constantes}

Várias funções e constantes elementares já estão pré-definidas no \verb+GNU Octave+. Por exemplo:
\begin{verbatim}
>> cos(pi) #cosseno de pi
ans = -1
>> sin(pi) #seno de pi
ans =    1.2246e-16
>> exp(1) == e
ans =  1
>> log(e) #logarítmo natural
ans =  1
\end{verbatim}

\subsection{Operadores lógicos}\index{Octave!operadores lógicos}

No \verb+GNU Octave+, o valor lógico verdadeiro é escrito como \verb+true+ e o valor lógico falso como \verb+false+. Temos os seguintes operadores lógicos disponíveis:
\begin{verbatim}
&  e lógico
|  ou lógico
!  negação
== igualdade
!= diferente
<  menor que
>  maior que
<= menor ou igual que
>= maior ou igual que
\end{verbatim}

\begin{ex}
  Se $x=2$, então $x$ é maior ou igual a 1 e menor que 3? 
\end{ex}
\begin{sol}
  No \verb+GNU Octave+, temos:
\begin{verbatim}
>> x=2;
>> (x >= 1) & (x < 3)
ans =  1
\end{verbatim}
\end{sol}

\section{Matrizes}\index{Octave!matrizes}

No \verb+GNU Octave+, matriz é o tipo básico de dados, a qual é definida por seu número de linhas, colunas e tipo de dado (real, inteiro, lógico, etc.). Uma matriz $A = [a_{i,j}]_{i,j=1}^{m,n}$ no \verb+GNU Octave+ é definida usando-se a seguinte sintaxe:
\begin{verbatim}
A = [ a11 , a12 , ... , a1n ; ...; am1 , am2 , ... , amn ]
\end{verbatim}

\begin{ex}
  Defina a matriz:
  \begin{equation}
    A = \left[
      \begin{array}{ccc}
        1 & 2 & 3\\
        4 & 5 & 6
      \end{array}
\right]
  \end{equation}
\end{ex}
\begin{sol}
  No \verb+GNU Octave+, digitamos:
\begin{verbatim}
>> A = [1 , 2 , 3 ; 4 , 5 , 6]
A =
   1   2   3
   4   5   6
\end{verbatim}
\end{sol}

A seguinte lista contém uma série de funções que geram matrizes particulares:
\begin{verbatim}
eye      matriz identidade
linspace vetor de elementos linearmente espaçados
ones     matriz cheia de uns
zeros    matriz nula
\end{verbatim}

\subsection{O operador ``:''}\index{GNU Octave!operador :}

O operador ``:'' cria um vetor linha de elementos. A sintaxe:
\begin{verbatim}
v = i:s:j
\end{verbatim}
cria um vetor linha:
\begin{equation}
  v = [i,~i+s,~i+2s,\dotsc, i+ns]
\end{equation}
onde $n$ é o maior inteiro tal que $i + ns \leq j$.

\begin{ex}
Veja as seguintes linhas de comando:
\begin{verbatim}
>> u = 2:6
u =
   2   3   4   5   6
>> v = 10:-2:3
v =
   10    8    6    4
\end{verbatim}
\end{ex}

\subsection{Obtendo dados de uma matriz}

A função \verb+size+ retorna as dimensões de uma matriz, por exemplo:
\begin{verbatim}
>> A = ones(3,2)
A =
   1   1
   1   1
   1   1 
>> [nl, nc] = size(A)
nl =  3
nc =  2
\end{verbatim}
informando que a matriz \verb+A+ tem três linhas e duas colunas.

Existem vários métodos para acessar os elementos de uma matriz dada \verb+A+:
\begin{itemize}
\item a matriz inteira acessa-se com a sintaxe:
\begin{verbatim}
A
\end{verbatim}
\item o elemento da $i$-ésima linha e $j$-ésima coluna acessa-se usando a sintaxe:
\begin{verbatim}
A(i,j)
\end{verbatim}
\item o bloco formado pelas linhas $i_1$, $i_2$ e pelas colunas $j_1$, $j_2$ obtém-se usando a sintaxe:
\begin{verbatim}
A(i1:i2, j1:j2)
\end{verbatim}
\end{itemize}

\begin{ex}
  Veja as seguintes linhas de comando:
\begin{verbatim}
>> A = rand(3,4)
A =
   0.356041   0.896038   0.761722   0.447774
   0.453682   0.071638   0.029215   0.500115
   0.885188   0.387276   0.566189   0.683588
>> A
A =
   0.356041   0.896038   0.761722   0.447774
   0.453682   0.071638   0.029215   0.500115
   0.885188   0.387276   0.566189   0.683588
>> A(2,3)
ans =  0.029215
>> A(2:3,2:4)
ans =
   0.071638   0.029215   0.500115
   0.387276   0.566189   0.683588
\end{verbatim}
\end{ex}

Definida uma matriz $A$ no \verb+GNU Octave+, as seguintes sintaxes são bastante úteis:
\begin{verbatim}
A(:,:)   toda a matriz
A(i:j,k) os elementos das linhas i até j (inclusive) da k-ésima coluna
A(i,j:k) os elementos da i-ésima linha das colunas j até k (inclusive)
A(i,:)   a i-ésima linha da matriz
A(:,j)   a j-ésima coluna da matriz
A(i,end) o elemento da i-ésima linha e da última coluna
A(end,j) o elemento da última linha e da j-ésima coluna
\end{verbatim}

\begin{ex}
Veja as seguintes linhas de comando:
\begin{verbatim}
>> B = rand(4,4)
B =

   0.246251   0.931915   0.094609   0.519181
   0.926740   0.898039   0.377078   0.260630
   0.133661   0.652755   0.670097   0.390773
   0.379430   0.314611   0.829729   0.484622

>> aux=B(:,2); B(:,2)=B(:,3); B(:,3)=aux
B =

   0.246251   0.094609   0.931915   0.519181
   0.926740   0.377078   0.898039   0.260630
   0.133661   0.670097   0.652755   0.390773
   0.379430   0.829729   0.314611   0.484622
\end{verbatim}
\end{ex}

\subsection{Operações matriciais e elemento-a-elemento}

As operações matriciais elementares seguem a mesma sintaxe que as operações elementares de números. Agora, no \verb+GNU Octave+, também podemos fazer operações elemento-a-elemento colocando um ponto ``.'' antes da operação desejada.

Aqui, temos as sintaxes análogas entre operações matriciais e operações elemento-a-elemento:
\begin{verbatim}
+ adição               .+ adição elemento-a-elemento
- subtração            .- subtração elemento-a-elemento
* multiplicação        .* multiplicação elemento-a-elemento
                       ./ divisão elemento-a-elemento
^ potenciação          .^ potenciação elemento-a-elemento
' transposta conjugada .' transposta (não conjugada)
\end{verbatim}

\begin{ex}
  Veja as seguintes linhas de comando:
\begin{verbatim}
>> A = ones (2,2)
A =
   1   1
   1   1

>> B = 2 * ones(2, 2)
B =
   2   2
   2   2

>> A * B
ans =
   4   4
   4   4

>> A .* B
ans =
   2   2
   2   2
\end{verbatim}
\end{ex}

\section{Estruturas de ramificação e repetição}\index{Octave!ramificação e repetição}

O \verb+GNU Octave+ contém estruturas de repetição e ramificação padrões de linguagens estruturadas.

\subsection{A instrução de ramificação ``if''}

A instrução ``if'' permite executar um pedaço do código somente se uma dada condição for satisfeita.

\begin{ex}
  Veja o seguinte código \verb+GNU Octave+:
\begin{verbatim}
i = 2;
if ( i == 1 )
    disp ( " Hello ! " );
elseif ( i == 2 )
    disp ( " Goodbye ! " );
elseif ( i == 3 )
    disp ( " Tchau ! " );
else
    disp ( " Au Revoir ! " );
endif
\end{verbatim}
Qual é a saída apresentada no console do \verb+GNU Octave+? Por quê?
\end{ex}

\subsection{A instrução de repetição ``for''}

A instrução \verb+for+ permite que um pedaço de código seja executado repetidamente.

\begin{ex}
  Veja o seguinte código:
\begin{verbatim}
for i = 1:5
    disp(i);
endfor
\end{verbatim}
O que é mostrado no console do \verb+GNU Octave+?
\end{ex}

\begin{ex}
  Veja o seguinte código:
\begin{verbatim}
for j = 1:2:8
    disp(j);
endfor
\end{verbatim}
O que é mostrado no console do \verb+GNU Octave+?
\end{ex}

\begin{ex}
  Veja o seguinte código:
\begin{verbatim}
for k = 10:-3:1
    disp(k);
endfor
\end{verbatim}
O que é mostrado no console do \verb+GNU Octave+?
\end{ex}

\begin{ex}
  Veja o seguinte código:
\begin{verbatim}
for i = 1:3
    for j = 1:3
        disp([i,j]);
    endfor
endfor
\end{verbatim}
O que é mostrado no console do \verb+GNU Octave+?
\end{ex}

\subsection{A instrução de repetição ``while''}

A instrução \verb+while+ permite que um pedaço de código seja executado repetidamente até que uma dada condição seja satisfeita.

\begin{ex}
Veja o seguinte código \verb+GNU Octave+:
\begin{verbatim}
s = 0;
i = 1;
while ( i <= 10 )
   s = s + i;
   i = i + 1;
endwhile
\end{verbatim}
Qual é o valor de \verb+s+ ao final da execução? Por quê?
\end{ex}

\section{Funções}\index{GNU Octave!funções}

Além das muitas funções já pré-definidas no \verb+GNU Octave+, podemos definir nossas próprias funções usando:
\begin{itemize}
\item \verb+Anonymous functions+
\item \verb+Functions (script)+
\end{itemize}

Definir uma função como \emph{anonymous function} é apropriada para funções com poucas instruções. Quando a função exige uma grande quantidade de código para ser definida, a melhor opção é usar a instrução \verb+function+. Veja os seguintes exemplos:

\begin{ex}
  O seguinte código:
\begin{verbatim}
>> f = @(x) x + sin(x)
f =
@(x) x + sin (x)
\end{verbatim}
define, no \verb+GNU Octave+, a função $f(x) = x + \sen x$.

Observe que $f(\pi) = \pi$. Confirme isso computando:
\begin{verbatim}
>> f(pi)
ans =  3.1416
\end{verbatim}
no \verb+GNU Octave+.

Alternativamente, definimos a mesma função com o código:
\begin{verbatim}
function [y] = f(x)
   y = x + sin(x);
endfunction
\end{verbatim}
Verifique!
\end{ex}

\begin{obs}
  Um {\it script} (por exemplo, \verb+CAMINHO/foo.m+) contendo apenas a declaração de uma função pode ser usado no prompt via o comando \verb+run+:
\begin{verbatim}
>> run "CAMINHO/foo.m"
\end{verbatim}
\end{obs}

\begin{ex}
  O seguinte código \verb+GNU Octave+:
\begin{verbatim}
function [z] = h(x,y)
   if (x < y)
      z = y - x;
   else
      z = x - y;
   endif
endfunction
\end{verbatim}
define a função:
\begin{equation}
  h(x,y) = \left\{
    \begin{array}{ll}
      y - x &, x < y\\
      x - y &, x \geq y
    \end{array}
\right.
\end{equation}
Verifique!
\end{ex}

\begin{ex}
  O seguinte código:
\begin{verbatim}
function [y] = J(x)
   y(1,1) = 2*x(1);
   y(1,2) = 2*x(2);

   y(2,1) = -x(2)*sin(x(1)*x(2));
   y(2,2) = -x(1)*sin(x(1)*x(2));
endfunction
\end{verbatim}
define a matriz jacobiana $J(x_1,x_2) := \frac{\p(f_1,f_2)}{\p(x_1,x_2)}$ da função:
\begin{equation}
  f(x_1,x_2) = (x_1^2 + x_2^2,~\cos(x_1x_2)).
\end{equation}
\end{ex}

\begin{ex}
  O seguinte código:
\begin{verbatim}
function [a,b] = v(x,y)
   if (x > y)
     a = 1;
     b = 2;
     return;
   else
     a = 2;
     b = 1;
     return;
   end
endfunction
\end{verbatim}
define a função $v$ que toma duas variáveis e retorna duas variáveis. Por exemplo:
\begin{verbatim}
>> [i,j] = v(3,2)
i =  1
j =  2
\end{verbatim}
\end{ex}

\section{Gráficos}\index{GNU Octave!gráficos}

Para criar um esboço do gráfico de uma função de uma variável real $y = f(x)$, podemos usar a função \verb+plot+. Esta função faz uma representação gráfica de pontos $(x_i, y_i)$ fornecidos. O \verb+GNU Octave+ oferece uma série de opções para esta função de forma que o usuário pode ajustar várias questões de visualização. Consulte sobre a função \verb+plot+ usando a ferramenta de ajuda do \verb+GNU Octave+:
\begin{verbatim}
>> help plot
\end{verbatim}

\begin{ex}
  Veja as seguintes linhas de código:
\begin{verbatim}
>> f = @(x) x .^3 + 1
>> xx = linspace(-2,2);
>> plot(xx,f(xx)); grid on
\end{verbatim}
\end{ex}
